<p id="notice"><%= notice %></p>

<header class="recipe__header">
  <div class="recipe__photo-container">
    <%= image_tag @recipe.photo, class: 'recipe__photo' %>
  </div>

  <main>
    <h2 class="ui header">
      <%= @recipe.name %>
      <div class="sub header">Recipes</div>
    </h2>

    <div class="ui horizontal divider">Stats</div>

    <div class="ui mini statistics">
      <div class="ui statistic">
        <div class="value">
          <i aria-hidden="true" class="gulp icon"></i>
          <%= @total_quantity %> <%= @recipe.recipe_items[0]&.quantity_scale %>
        </div>
        <div class="label">
          Total Volume
        </div>
      </div>

      <div class="ui statistic">
        <div class="value">
          <i aria-hidden="true" class="angle double down icon"></i>
          <%= @total_cost %>
        </div>
        <div class="label">Total Cost</div>
      </div>

      <% if @recipe.sale_price %>
        <div class="ui statistic">
          <div class="value">
            <i aria-hidden="true" class="money bill alternate outline icon"></i>
            <%= @recipe.sale_price %>
          </div>
          <div class="label">Sale Price</div>
        </div>

        <div class="ui statistic">
          <div class="value">
            <i aria-hidden="true" class="angle double up icon"></i>
            <%= @recipe.sale_price - @total_cost %>
          </div>
          <div class="label">Profit</div>
        </div>

        <div class="ui statistic">
          <div class="value"><%= (@recipe.sale_price - @total_cost) / @recipe.sale_price * 100 %>%</div>
          <div class="label">Margin</div>
        </div>

        <div class="ui statistic">
          <div class="value">
            <i aria-hidden="true" class="users icon"></i>
            ?
          </div>
          <div class="label">Unit Sales</div>
        </div>
      <% end %>
    </div>
  </main>
</header>

<div class="ui horizontal divider">Items</div>

<table class="ui celled table compact">
  <thead>
  <tr>
    <th>Item</th>
    <th>Quantity</th>
    <th>Cost</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @recipe.recipe_items.each do |recipe_item| %>
    <tr>
      <td><%= recipe_item.inventory_item.kitchen_item.name %></td>
      <td><%= recipe_item.quantity %> <%= recipe_item.quantity_scale %></td>
      <td><%= recipe_item.cost %></td>
      <td><%= link_to 'Show', [recipe_item.recipe, recipe_item] %></td>
      <td><%= link_to 'Edit', edit_recipe_recipe_item_path(recipe_item.recipe, recipe_item) %></td>
      <td><%= link_to 'Destroy', [recipe_item.recipe, recipe_item], method: :delete, data: { confirm: 'Are you sure?' } %></td>
    </tr>
  <% end %>
  </tbody>
</table>

<footer class="ui footer">
  <%= form_new_button new_recipe_recipe_item_path(@recipe), "New Recipe Item" %>

  <%= link_to 'Edit', edit_recipe_path(@recipe) %> |
  <%= link_to 'Back', recipes_path %>
</footer>
